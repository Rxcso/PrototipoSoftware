@{
    ViewBag.Title = "Asientos";
    int idEvento = int.Parse(ViewBag.idEvento);
}
<head>
    <link href="@Url.Content("~/Content/asientos.css")" rel="stylesheet" type="text/css" />
</head>
<body>
    <style>
        #aux {
            background-color: lightgray;
            border: 1px solid black;
            height: 50px;
        }

        #canvas {
            border: 1px solid black;
            height: 700px;
        }
    </style>

    <div class="container-fluid">
        <div class="col-md-5">
            <ol class="breadcrumb">
                <li><a href="@Url.Action("Index","Evento")">Mantenimiento de eventos</a></li>
                <li class="active">Configurar asientos</li>
            </ol>
        </div>
    </div>
    <div class="container">
        <div class="row form-group">
            <label for="idEvento" class="control-label col-md-4">ID Evento:</label>
            <div class="col-md-8">
                <input id="eventoP" type="text" class="form-control" value=@idEvento disabled>
            </div>
        </div>

        <div class="row form-group">
            <label for="nombreEvento" class="control-label col-md-4">Nombre Evento:</label>
            <div class="col-md-8">
                <input type="text" class="form-control" placeholder="@ViewBag.nombreEvento" disabled>
            </div>
        </div>
    </div>
    <div id="cont" class="container">
        <div class="row form-group">
            @*Sacar las zonas del evento*@
            <select class="form-control" name="" id="">
                <option value="">VIP</option>
                <option value="">GENERAL</option>
                <option value="">ALTA</option>
                <option value="">PLATEA</option>
            </select>
        </div>
        <div class="row form-group">
            <label for="nombre" class="control-label col-md-2 col-sm-2">N° filas:</label>
            <div class="col-md-1 col-sm-1">
                <input type="number" class="form-control" id="filas">
            </div>
            <label for="nombre" class="control-label col-md-2 col-md-offset-2 col-sm-2">N° Columnas:</label>
            <div class="col-md-1 col-sm-1">
                <input type="number" class="form-control" id="columnas">
            </div>
            <div class="col-md-2 col-sm-2">
                <button id="generar" class="btn btn-primary" onclick="generarAsientos()">Generar</button>
            </div>
            <div class="col-md-2 col-sm-2">
                <button id="guardar" class="btn btn-primary">Guardar Distribución <span class="glyphicon glyphicon-save"></span> </button>
            </div>
        </div>
        <div class="row">
            <div id="canvas" class="col-md-12">
            </div>
        </div>
        <div class="row">
            <div id="aux" class="col-md-12">
            </div>
        </div>
    </div>
        
    <script>
        function generarAsientos() {
            $("#canvas").empty();
            //Definición del lado
            var d;
            if ($("#canvas").width() > $("#canvas").height()) {
                d = $("#canvas").height();
            } else {
                d = $("#canvas").width();
            }
            d *= 0.99;
            //console.log(d);

            var cantFilas = $("#filas").val();
            var cantColumnas = $("#columnas").val();



            //BORDE
            $('<div id="grilla-borde"></div>').appendTo('#canvas');
            $('#grilla-borde').css('width', d + 'px');
            $('#grilla-borde').css('height', d + 'px');
            //

            //INTERIOR
            $('<div id="grilla-interna"></div>').appendTo('#grilla-borde');
            $('#grilla-interna').css('width', 96 + '%');
            $('#grilla-interna').css('height', 96 + '%');
            $('#grilla-interna').css('margin', 2 + '%');
            //

            //ABAJO
            $('<div id="info" style="text-align:center; font-size:18px;"></div>').appendTo('#aux');
            //

            //FILAS
            var altoFilas = 0.9 * 100 / cantFilas;
            var marginTopFilas = 0.1 * 100 / (cantFilas - 1);
            var anchoFilas = 100 / 1;

            for (var i = 0 ; i < cantFilas ; i++) {
                $('<div class="filas ' + 'fila_' + (i + 1) + '"></div>').appendTo('#grilla-interna');
            }

            $('.filas').each(function () {
                $(this).css('width', anchoFilas + '%');
                $(this).css('height', altoFilas + '%');
                if (!$(this).is(':first-child')) {
                    $(this).css('margin-top', marginTopFilas + '%');
                }
            });
            //

            //CELDAS
            var altoCeldas = 100 / 1;
            var anchoCeldas = 0.9 * 100 / cantColumnas;
            var leftCeldas = 0.1 * 100 / (cantColumnas - 1);

            for (var i = 0 ; i < cantColumnas ; i++)
                for (var j = 1 ; j <= cantFilas ; j++) {
                    $('<div class="celdas ' + 'columna_' + (i + 1) + ' "></div>').appendTo('#grilla-interna .filas:nth-child(' + j + ')');
                }

            $('.celdas').each(function () {
                $(this).css('width', anchoCeldas + '%'); $(this).css('height', altoCeldas + '%');
                if (!$(this).is(':first-child')) { $(this).css('margin-left', leftCeldas + '%'); }
            });
            //

            //LLENAR
            for (var i = 1 ; i <= cantFilas ; i++)
                for (var j = 1 ; j <= cantColumnas ; j++) {
                    $('<div class="ficha"></div>').appendTo('.filas:nth-child(' + i + ') .celdas:nth-child(' + j + ')');
                }
            //



            $('body').on('mouseover', '.celdas', function () {
                var filaN = $(this).parent().attr('class').split('_');
                var columnaN = $(this).attr('class').split('_');

                $('#info').text('Fila: ' + filaN[1] + ' - Columna ' + columnaN[1]);
            });


            $('body').on('click', '.ficha', function () {
                $(this).addClass("eliminado");
            });
            $('body').on('dblclick', '.ficha', function () {
                $(this).removeClass("eliminado")
            });


        }

    </script>
</body>
